<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Messenger Bot Login</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap');

    body {
      background: #000;
      color: #0f0;
      font-family: 'Share Tech Mono', monospace;
      padding: 40px;
      margin: 0;
    }

    .container {
      max-width: 1000px;
      margin: auto;
    }

    h2, h3 {
      color: #00ffcc;
      border-bottom: 1px solid #0f0;
      padding-bottom: 8px;
    }

    textarea {
      width: 100%;
      height: 220px;
      background: #111;
      color: #0f0;
      border: 1px solid #0f0;
      padding: 10px;
      font-size: 16px;
    }

    button {
      margin-top: 15px;
      padding: 10px 20px;
      background: #00ffcc;
      color: #000;
      font-weight: bold;
      border: none;
      cursor: pointer;
      font-family: 'Share Tech Mono', monospace;
    }

    .command {
      margin: 5px 0;
      padding-left: 10px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>🤖 Paste AppState JSON</h2>
    <textarea id="appstateInput" placeholder="Paste your AppState array here..."></textarea><br />
    <button onclick="submitAppState()">Login & Start Bot</button>

    <h3>📜 Available Commands</h3>
    <div id="commands">Loading...</div>
  </div>

  <script>
    async function submitAppState() {
      const raw = document.getElementById("appstateInput").value;
      try {
        const json = JSON.parse(raw);
        const res = await fetch("/upload-json", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ appState: json })
        });
        alert(await res.text());
      } catch {
        alert("❌ Invalid JSON format");
      }
    }

    fetch("/commands")
      .then(res => res.json())
      .then(cmds => {
        const div = document.getElementById("commands");
        div.innerHTML = "";
        cmds.forEach(cmd => {
          const el = document.createElement("div");
          el.className = "command";
          el.textContent = `• ${cmd.name} - ${cmd.description}`;
          div.appendChild(el);
        });
      });
  </script>
</body>
</html>